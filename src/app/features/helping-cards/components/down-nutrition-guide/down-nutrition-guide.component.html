<section dir="rtl" class="mx-auto max-w-[1100px] px-3 md:px-6 py-6">
  <!-- HERO -->
  <header class="rounded-3xl border border-black/5 shadow-sm overflow-hidden bg-white">
    <div class="p-5 md:p-8 bg-gradient-to-br from-emerald-500/10 via-sky-500/10 to-amber-500/10">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-3">
        <div>
          <h1 class="m-0 text-[26px] md:text-[42px] font-extrabold text-slate-900 leading-tight">
            {{ heading }}
          </h1>
          <p class="mt-2 mb-0 text-slate-800/80 leading-8 font-semibold max-w-[900px]">
            {{ sub }}
          </p>
        </div>

        <!-- Search -->
        <div class="w-full md:w-[320px]">
          <div class="rounded-2xl bg-white/80 border border-black/10 px-3 py-2 flex items-center gap-2">
            <i class="pi pi-search text-slate-500"></i>
            <input type="text"
              class="w-full bg-transparent outline-none text-slate-900 font-semibold placeholder:text-slate-400"
              placeholder="ابحثي داخل الدليل…" [value]="search()"
              (input)="search.set(($any($event.target).value || ''))" />
            <button *ngIf="search()" type="button"
              class="w-8 h-8 rounded-full grid place-items-center hover:bg-slate-900/5" (click)="search.set('')"
              aria-label="مسح">
              <i class="pi pi-times text-slate-500"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- badges -->
      <div class="mt-4 flex flex-wrap gap-2">
        <span *ngFor="let b of heroBadges; trackBy: trackByIndex" class="inline-flex items-center gap-2 rounded-full px-3 py-1.5
                 bg-white/85 border border-black/10 text-slate-800 font-extrabold text-[13px]">
          <span class="w-2 h-2 rounded-full bg-emerald-500/60"></span>
          {{ b }}
        </span>
      </div>

      <!-- QUICK NAV -->
      <div class="mt-5">
        <div class="text-slate-900 font-extrabold mb-2 flex items-center gap-2">
          <i class="pi pi-compass text-sky-600"></i>
          تنقّل سريع
        </div>

        <div class="flex gap-2 overflow-x-auto pb-1 [-webkit-overflow-scrolling:touch]">
          <a href="#intro" class="shrink-0 inline-flex items-center gap-2 rounded-full px-3 py-2 bg-white/85 border border-black/10
                   text-slate-900 font-extrabold text-[13px] hover:bg-white">
            <i class="pi pi-info-circle text-sky-600"></i> مقدمة
          </a>

          <a href="#quick" class="shrink-0 inline-flex items-center gap-2 rounded-full px-3 py-2 bg-white/85 border border-black/10
                   text-slate-900 font-extrabold text-[13px] hover:bg-white">
            <i class="pi pi-star-fill text-amber-500"></i> إرشادات عامة
          </a>

          <a href="#age" class="shrink-0 inline-flex items-center gap-2 rounded-full px-3 py-2 bg-white/85 border border-black/10
                   text-slate-900 font-extrabold text-[13px] hover:bg-white">
            <i class="pi pi-clock text-emerald-600"></i> حسب العمر
          </a>

          <a href="#conditions" class="shrink-0 inline-flex items-center gap-2 rounded-full px-3 py-2 bg-white/85 border border-black/10
                   text-slate-900 font-extrabold text-[13px] hover:bg-white">
            <i class="pi pi-sliders-h text-indigo-600"></i> حسب الحالة المصاحبة
          </a>

          <a href="#heart" class="shrink-0 inline-flex items-center gap-2 rounded-full px-3 py-2 bg-white/85 border border-black/10
                   text-slate-900 font-extrabold text-[13px] hover:bg-white">
            <i class="pi pi-heart-fill text-rose-600"></i> حالات القلب
          </a>

          <a href="#meals" class="shrink-0 inline-flex items-center gap-2 rounded-full px-3 py-2 bg-white/85 border border-black/10
                   text-slate-900 font-extrabold text-[13px] hover:bg-white">
            <i class="pi pi-list text-emerald-600"></i> أمثلة وجبات
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- INTRO -->
  <section id="intro" class="mt-4 grid grid-cols-1 lg:grid-cols-2 gap-3 scroll-mt-24">
    <article *ngFor="let b of filtered(introBlocks); trackBy: trackByIndex"
      class="rounded-3xl bg-white border border-black/5 shadow-sm p-5 md:p-6">
      <div class="flex items-start gap-3">
        <div class="w-11 h-11 rounded-2xl grid place-items-center bg-sky-500/10 border border-sky-500/15 shrink-0">
          <i class="pi pi-info-circle text-sky-600"></i>
        </div>

        <div>
          <h2 class="m-0 text-[18px] md:text-[20px] font-extrabold text-slate-900">
            {{ b.title }}
          </h2>

          <p *ngIf="b.desc" class="mt-2 text-slate-800/80 leading-8 font-semibold">
            {{ b.desc }}
          </p>

          <ul *ngIf="b.points?.length" class="mt-3 space-y-1.5 text-slate-800/80 font-semibold leading-7">
            <li *ngFor="let p of b.points; trackBy: trackByIndex" class="flex gap-2">
              <span class="mt-2 w-2 h-2 rounded-full bg-sky-500/60 shrink-0"></span>
              <span>{{ p }}</span>
            </li>
          </ul>
        </div>
      </div>
    </article>
  </section>

  <!-- QUICK / GENERAL -->
  <section id="quick" class="mt-4 rounded-3xl bg-white border border-black/5 shadow-sm p-5 md:p-6 scroll-mt-24">
    <div class="flex items-center justify-between gap-3 flex-wrap">
      <div class="flex items-center gap-2">
        <i class="pi pi-star-fill text-amber-500"></i>
        <h2 class="m-0 text-[18px] md:text-[22px] font-extrabold text-slate-900">
          إرشادات عامة سريعة (تصلح لكل المراحل)
        </h2>
      </div>

      <div
        class="text-[12px] font-extrabold text-slate-700/80 bg-slate-900/[0.03] border border-black/5 rounded-full px-3 py-2">
        ✅ ابدئي بهذه النقاط قبل أي تخصيص حسب العمر أو الحالة
      </div>
    </div>

    <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
      <article *ngFor="let g of filtered(generalTips); trackBy: trackByIndex"
        class="rounded-3xl border border-black/5 bg-slate-900/[0.02] p-4">
        <div class="font-extrabold text-slate-900">{{ g.title }}</div>

        <p *ngIf="g.desc" class="mt-2 text-slate-800/80 leading-7 font-semibold">
          {{ g.desc }}
        </p>

        <ul *ngIf="g.points?.length" class="mt-3 space-y-1.5 text-slate-800/80 font-semibold leading-7">
          <li *ngFor="let p of g.points; trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-amber-500/60 shrink-0"></span>
            <span>{{ p }}</span>
          </li>
        </ul>
      </article>
    </div>
  </section>

  <!-- AGE STAGES -->
  <section id="age" class="mt-4 rounded-3xl bg-white border border-black/5 shadow-sm p-5 md:p-6 scroll-mt-24">
    <div class="flex items-center gap-2">
      <i class="pi pi-clock text-emerald-600"></i>
      <h2 class="m-0 text-[18px] md:text-[22px] font-extrabold text-slate-900">
        التغذية حسب العمر
      </h2>
    </div>

    <div class="mt-4 grid grid-cols-1 lg:grid-cols-3 gap-3">
      <article *ngFor="let s of filtered(ageStages); trackBy: trackByIndex"
        class="rounded-3xl border border-black/5 bg-slate-900/[0.02] p-4">
        <div class="font-extrabold text-slate-900 text-[16px]">
          {{ s.title }}
        </div>

        <p *ngIf="s.desc" class="mt-2 text-slate-800/80 leading-7 font-semibold">
          {{ s.desc }}
        </p>

        <ul *ngIf="s.points?.length" class="mt-3 space-y-1.5 text-slate-800/80 font-semibold leading-7">
          <li *ngFor="let p of s.points; trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-emerald-500/60 shrink-0"></span>
            <span>{{ p }}</span>
          </li>
        </ul>
      </article>
    </div>
  </section>

  <!-- CONDITIONS (TABS) -->
  <section id="conditions" class="mt-4 rounded-3xl bg-white border border-black/5 shadow-sm p-5 md:p-6 scroll-mt-24">
    <div class="flex items-center gap-2">
      <i class="pi pi-sliders-h text-indigo-600"></i>
      <h2 class="m-0 text-[18px] md:text-[22px] font-extrabold text-slate-900">
        {{ companionDietAdjustments.title }}
      </h2>
    </div>

    <div class="mt-2 text-slate-800/75 font-semibold leading-7">
      اختاري الحالة المصاحبة لتظهَر التعديلات مباشرة.
    </div>

    <div class="mt-4 mt-4 rounded-3xl border border-black/5 bg-white shadow-sm p-3 md:p-4 ">
      <p-tabs [value]="activeConditionTab()" (valueChange)="activeConditionTab.set($any($event))">
        <p-tablist class="!flex !flex-wrap md:!flex-nowrap !gap-2">
          <p-tab *ngFor="let t of companionTabs; trackBy: trackByIndex" [value]="t.value" class="!rounded-2xl">
            {{ t.label }}
          </p-tab>
        </p-tablist>

        <p-tabpanels class="mt-3">
          <p-tabpanel *ngFor="let t of companionTabs; trackBy: trackByIndex" [value]="t.value">
            <ng-container *ngIf="companionItemsByTag(t.tag).length; else noCondRes">
              <article class="rounded-3xl border border-black/5 bg-slate-900/[0.02] p-4">
                <div class="flex items-start justify-between gap-3">
                  <div class="font-extrabold text-slate-900 text-[16px] md:text-[18px] leading-snug">
                    {{ companionItemsByTag(t.tag)[0].title }}
                  </div>

                  <span *ngIf="companionItemsByTag(t.tag)[0].tag" class="shrink-0 inline-flex items-center rounded-full px-3 py-1 text-[12px]
                           bg-indigo-500/10 border border-indigo-500/15 text-indigo-700 font-extrabold">
                    {{ companionItemsByTag(t.tag)[0].tag }}
                  </span>
                </div>

                <ul *ngIf="companionItemsByTag(t.tag)[0].points?.length"
                  class="mt-3 space-y-1.5 text-slate-800/80 font-semibold leading-7">
                  <li *ngFor="let p of companionItemsByTag(t.tag)[0].points; trackBy: trackByIndex" class="flex gap-2">
                    <span class="mt-2 w-2 h-2 rounded-full bg-indigo-500/60 shrink-0"></span>
                    <span>{{ p }}</span>
                  </li>
                </ul>
              </article>
            </ng-container>

            <ng-template #noCondRes>
              <div class="rounded-3xl border border-black/5 bg-amber-500/10 p-4 font-extrabold text-slate-900">
                لا توجد نتائج مطابقة للبحث داخل هذا التبويب.
              </div>
            </ng-template>
          </p-tabpanel>
        </p-tabpanels>
      </p-tabs>
    </div>
  </section>

  <!-- HEART CASE -->
  <section id="heart" class="mt-4 rounded-3xl bg-white border border-black/5 shadow-sm overflow-hidden scroll-mt-24">
    <div class="p-5 md:p-6 bg-gradient-to-br from-rose-500/10 via-white to-sky-500/10">
      <div class="flex items-center gap-2">
        <i class="pi pi-heart-fill text-rose-600"></i>
        <h2 class="m-0 text-[18px] md:text-[22px] font-extrabold text-slate-900">
          حالات القلب الخِلقية: التغذية + الإرشادات الأساسية
        </h2>
      </div>

      <ul class="mt-4 space-y-2 text-slate-800/85 font-semibold leading-7">
        <li *ngFor="let x of filterTextList(heartIntro); trackBy: trackByIndex" class="flex gap-2">
          <span class="mt-2 w-2 h-2 rounded-full bg-rose-500/60 shrink-0"></span>
          <span>{{ x }}</span>
        </li>
      </ul>
    </div>

    <div class="p-5 md:p-6 grid grid-cols-1 lg:grid-cols-2 gap-3">
      <div class="rounded-3xl border border-black/5 bg-white p-4">
        <div class="font-extrabold text-slate-900 mb-2">لماذا التغذية مهمة جدًا هنا؟</div>
        <ul class="space-y-1.5 text-slate-800/80 font-semibold leading-7">
          <li *ngFor="let x of filterTextList(heartWhy); trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-rose-500/60 shrink-0"></span>
            <span>{{ x }}</span>
          </li>
        </ul>
      </div>

      <div class="rounded-3xl border border-black/5 bg-white p-4">
        <div class="font-extrabold text-slate-900 mb-2">السعرات والبروتين</div>
        <ul class="space-y-1.5 text-slate-800/80 font-semibold leading-7">
          <li *ngFor="let x of filterTextList(heartCaloriesProtein); trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-sky-500/60 shrink-0"></span>
            <span>{{ x }}</span>
          </li>
        </ul>
      </div>

      <div class="rounded-3xl border border-black/5 bg-white p-4 lg:col-span-2">
        <div class="font-extrabold text-slate-900 mb-2">طرق زيادة السعرات بدون تكبير حجم الوجبة</div>
        <ul class="space-y-1.5 text-slate-800/80 font-semibold leading-7">
          <li *ngFor="let x of filterTextList(heartHighCaloriesTips); trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-amber-500/60 shrink-0"></span>
            <span>{{ x }}</span>
          </li>
        </ul>
      </div>

      <div class="rounded-3xl border border-black/5 bg-white p-4">
        <div class="font-extrabold text-slate-900 mb-2">أطعمة مفيدة للقلب والصحة</div>
        <ul class="space-y-1.5 text-slate-800/80 font-semibold leading-7">
          <li *ngFor="let x of filterTextList(heartHealthyFoods); trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-emerald-500/60 shrink-0"></span>
            <span>{{ x }}</span>
          </li>
        </ul>
      </div>

      <div class="rounded-3xl border border-black/5 bg-white p-4">
        <div class="font-extrabold text-slate-900 mb-2">ما يجب تقليله/تجنبه</div>
        <ul class="space-y-1.5 text-slate-800/80 font-semibold leading-7">
          <li *ngFor="let x of filterTextList(heartAvoid); trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-rose-500/60 shrink-0"></span>
            <span>{{ x }}</span>
          </li>
        </ul>
      </div>

      <div class="rounded-3xl border border-black/5 bg-indigo-500/10 p-4 lg:col-span-2">
        <div class="font-extrabold text-slate-900 mb-2">ملاحظات مهمة</div>
        <ul class="space-y-1.5 text-slate-900/90 font-semibold leading-7">
          <li *ngFor="let x of filterTextList(heartNotes); trackBy: trackByIndex" class="flex gap-2">
            <span class="mt-2 w-2 h-2 rounded-full bg-indigo-500/60 shrink-0"></span>
            <span>{{ x }}</span>
          </li>
        </ul>
      </div>
    </div>
  </section>

  <!-- MEAL EXAMPLES -->
  <section id="meals" class="mt-4 rounded-3xl bg-white border border-black/5 shadow-sm p-5 md:p-6 scroll-mt-24">
    <div class="flex items-center gap-2">
      <i class="pi pi-list text-emerald-600"></i>
      <h2 class="m-0 text-[18px] md:text-[22px] font-extrabold text-slate-900">
        أمثلة وجبات يومية (لحالات القلب)
      </h2>
    </div>

    <div class="mt-4 space-y-3">
      <article *ngFor="let d of mealDays; trackBy: trackByIndex"
        class="rounded-3xl border border-black/5 bg-slate-900/[0.02] overflow-hidden">
        <div class="p-4 md:p-5 bg-gradient-to-l from-emerald-500/10 via-white to-sky-500/10">
          <div class="font-extrabold text-slate-900 text-[16px] md:text-[18px]">
            {{ d.title }}
          </div>
          <div *ngIf="d.subtitle" class="mt-1 text-slate-700/80 font-bold">
            {{ d.subtitle }}
          </div>
        </div>

        <div class="p-4 md:p-5">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div *ngFor="let m of d.meals; trackBy: trackByIndex"
              class="rounded-2xl bg-white border border-black/5 p-4">
              <div class="font-extrabold text-slate-900 mb-1">{{ m.time }}</div>
              <div class="text-slate-800/80 font-semibold leading-7">{{ m.text }}</div>
            </div>
          </div>

          <div *ngIf="d.quickTips?.length" class="mt-3 rounded-2xl bg-amber-500/10 border border-amber-500/15 p-4">
            <div class="font-extrabold text-slate-900 mb-2">نصائح سريعة</div>
            <ul class="space-y-1.5 text-slate-900/90 font-semibold leading-7">
              <li *ngFor="let t of d.quickTips; trackBy: trackByIndex" class="flex gap-2">
                <span class="mt-2 w-2 h-2 rounded-full bg-amber-500/70 shrink-0"></span>
                <span>{{ t }}</span>
              </li>
            </ul>
          </div>
        </div>
      </article>
    </div>

    <div class="mt-4 rounded-3xl bg-rose-500/10 border border-rose-500/15 p-4 font-extrabold text-slate-900 leading-7">
      ⚠️ الأمثلة إرشادية — عدّليها حسب العمر والوزن وحالة القلب وتوجيه الطبيب.
    </div>
  </section>
</section>