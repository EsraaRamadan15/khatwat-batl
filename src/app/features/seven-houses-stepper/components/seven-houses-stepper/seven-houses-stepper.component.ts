import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ButtonModule } from 'primeng/button';
import { StepsModule } from 'primeng/steps';
import { MenuItem } from 'primeng/api';
import { HouseStep } from '../../models/seven-houses';



@Component({
  selector: 'app-seven-houses-stepper',
  standalone: true,
  imports: [CommonModule, StepsModule, ButtonModule],
  templateUrl: './seven-houses-stepper.component.html',
  styleUrls: ['./seven-houses-stepper.component.scss'],
})
export class SevenHousesStepperComponent  {
  activeIndex = 0;

  introTitle = 'رحلة القلب القوي';
  introSub =
    'نُعالج الطفل… ونُرمم قلب الأم. نموذج عملي يربط رحلة العلاج بمنازل الروح السبعة لدعم أولياء الأمور (التوحد وداون).';

  steps: HouseStep[] = [
    {
      title: 'منزلة التقوى',
      stage: 'عند الصدمة والتشتت والخوف',
      parentsState: ['قلق', 'خوف من المستقبل', 'اضطراب'],
      coreIdea: 'التقوى = أن يكون الله هو الأمان الداخلي، لا النتائج ولا التقارير الطبية.',
      practical: [
        'ربط القلب بالله قبل ربطه بالتشخيص',
        'اكتبي: ما الذي أستطيع فعله؟ وما الذي أتركه لله؟',
      ],
      daily: ['"حسبنا الله ونعم الوكيل" 100 مرة يوميًا'],
      exercise: ['قسّمي ورقة: (أتحكم فيه) / (لا أتحكم فيه) ثم اكتبي تحت الثانية: "أسلمها لله"'],
      effect: ['يقل القلق', 'يثبت القلب وقت الأخبار الطبية الصعبة'],
      message: 'أنتِ لا تمسكين الكون… أنتِ تمسكين بيد الله.',
    },
    {
      title: 'منزل اليقين',
      stage: 'وسط الغموض: هل سيتحسن؟',
      parentsState: ['شك', 'خوف من المستقبل', 'توتر مع كل تقرير'],
      coreIdea: 'اليقين = الثقة في مدبّر الأحداث، وليس معرفة ما سيحدث.',
      practical: [
        'ترسيخ: "وما ذلك على الله بعزيز"',
        'اكتبي يوميًا: "أنا موقنة أن الله يدبر أمري وابني خير تدبير"',
      ],
      daily: ['"فوضت أمري إلى الله" 33 مرة يوميًا'],
      exercise: [
        'اكتبي 5 مخاوف ثم (ما الذي أستطيع فعله؟ وما الذي أتركه لله؟)',
        'اختمي: "أنا أفعل ما عليّ… وأثق أن الله يفعل ما هو أفضل"',
      ],
      effect: ['يمنع اليأس', 'يعالج الخوف من المستقبل'],
      message: 'اليقين ليس أن تطمئن للأحداث… اليقين أن تطمئن لرب الأحداث.',
    },
    {
      title: 'منزل التوكل',
      stage: 'الإرهاق من كثرة البحث والأطباء',
      parentsState: ['احتراق نفسي', 'شعور: أنا شايلة الدنيا لوحدي'],
      coreIdea: 'التوكل = عمل بالأسباب + راحة قلب في النتائج.',
      practical: [
        'المعادلة: أعمل اللي عليّ… وأسيب النتيجة لله',
        'قبل قرار مهم: ركعتين استخارة',
      ],
      daily: ['"حسبي الله لا إله إلا هو عليه توكلت" 100 مرة'],
      exercise: [
        '3 أعمدة: (دوري الحقيقي) / (دور الله) / (هموم شايلها غلط)',
        'اختمي: "اللهم إني قمت بما أستطيع… فاكفني ما لا أستطيع"',
      ],
      effect: ['يخف الاحتراق النفسي', 'يزيل الإحساس: أنا شايلة لوحدي'],
      message: 'أنا أسعى كأن الأمر بيدي… وأطمئن كأن الأمر كله بيد الله.',
    },
    {
      title: 'منزل التسليم',
      stage: 'لماذا أنا؟ لماذا ابني؟',
      parentsState: ['اعتراض صامت', 'غضب مكتوم', 'حزن عميق'],
      coreIdea: 'التسليم ≠ الاستسلام. التسليم هو السلام مع القدر مع استمرار السعي.',
      practical: ['اكتبي: "أنا لا أفهم كل الحكمة… لكني أثق في الحكيم"'],
      effect: ['يوقف الصراع الداخلي', 'يحرر القلب من الغضب المكتوم'],
    },
    {
      title: 'منزل الرضا',
      stage: 'العمل بدون سخط',
      parentsState: ['مقارنات', 'حزن مزمن', 'صعوبة تقبل الواقع'],
      coreIdea: 'الرضا لا يغيّر الطريق… لكنه يغيّر تجربة السير فيه.',
      practical: [
        'اكتبي 3 أشياء جميلة في طفلك كل يوم',
        'الرضا عن القدر مع الاستمرار في العلاج (الرضا ≠ الاستسلام)',
      ],
      daily: ['"رضيت بالله ربًا" 100 مرة'],
      effect: ['يمنع الاكتئاب', 'يخلق علاقة صحية مع الطفل'],
      message: 'الرضا لا يغيّر الطريق… لكنه يغيّر تجربة السير فيه.',
    },
    {
      title: 'منزل العبودية',
      stage: 'حين يتحول التعب إلى عبادة',
      parentsState: ['إرهاق', 'إحساس بالطحن النفسي'],
      coreIdea: 'أنا لا أخدم ابني فقط… أنا أتقرب إلى الله بخدمته.',
      practical: ['نية: "اللهم هذه الرعاية لوجهك الكريم"'],
      daily: ['"اللهم تقبل مني" 50 مرة'],
      effect: ['التعب يتحول لأجر', 'المعاناة تتحول لعبادة'],
    },
    {
      title: 'منزل محبة الله',
      stage: 'التحول من الابتلاء للرسالة',
      parentsState: ['ربط العلاقة بالله بالنتائج فقط'],
      coreIdea: 'أحب الله لأنه هو الله… لا لأن الظروف مريحة.',
      practical: [
        'تمرين: "يا رب إن لم يكن هذا غضبًا منك فلا أبالي"',
        'اكتبي: أشياء تحبيها في ربنا (رحمته، ستره، قربه)',
      ],
      effect: ['سلام داخلي عميق', 'قوة نفسية نادرة', 'يتحول الألم لنور ورسالة'],
    },
  ];

  items: MenuItem[] = [];

  ngOnInit() {
    this.items = this.steps.map((s, i) => ({
      label: `${i + 1}`,
      command: () => (this.activeIndex = i),
    }));
  }

  prev() {
    if (this.activeIndex > 0) this.activeIndex--;
  }

  next() {
    if (this.activeIndex < this.steps.length - 1) this.activeIndex++;
  }

  get current() {
    return this.steps[this.activeIndex];
  }
}
